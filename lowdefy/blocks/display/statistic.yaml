id: statistic
type: page_sider_menu
public: true
properties:
  title: Statistic
blocks:
  _ref:
    path: blocks/template.yaml
    vars:
      block_name: Statistic
      description_content: |
        A statistic header block.
      block_type: statistic
      label: false
      kind: display
      css_transform:
        _get:
          key: "0"
          on:
            _mql_aggregate:
              pipeline:
                - $addFields:
                    $prefix_icon:
                      _parse:
                        _state: css_prefix_icon_input
                    $suffix_icon:
                      _parse:
                        _state: css_suffix_icon_input
              on:
                _parse:
                  _state: css_block_input
      css_form:
        - id: css_block_input
          type: text_area_input
          css:
            --span: 11
            sm:
              --span: 11
            $label:
              --span: 2
          defaultValue: "{}"
          properties:
            title: block
            rows: 3
            size: small
            $label:
              extra: CSS Object style properties. Should be in JSON format.
        - id: css_prefix_icon_input
          type: text_area_input
          css:
            --span: 11
            sm:
              --span: 11
            $label:
              --span: 3
          defaultValue: "{}"
          properties:
            title: $prefix_icon
            rows: 3
            size: small
            $label:
              extra: CSS Object style properties. Should be in JSON format.
        - id: css_suffix_icon_input
          type: text_area_input
          css:
            --span: 11
            sm:
              --span: 11
            $label:
              --span: 3
          defaultValue: "{}"
          properties:
            title: $suffix_icon
            rows: 3
            size: small
            $label:
              extra: CSS Object style properties. Should be in JSON format.
      properties_transform:
        _state: block.properties
      properties_form:
        - id: block.properties.title
          type: text_input
          defaultValue: block_id
          css:
            $label:
              --span: 2
          properties:
            title: title
            size: small
            $label:
              extra: Title to describe the input component, if no title is specified the block id is displayed.
        - id: select_value_type_card
          type: card
          blocks:
            - id: select_value_type
              type: radio_button_input
              defaultValue: Number
              properties:
                title: value Type
                size: small
                $label:
                  extra: The display value can be either a String or a Number.
                options:
                  - Number
                  - String
        - id: value_number
          field: block.properties.value
          type: number_input
          css:
            $label:
              --span: 2
          visible:
            _mql_test:
              select_value_type: Number
          properties:
            title: value
            size: small
            $label:
              extra: Display number value.
        - id: value_text
          field: block.properties.value
          type: text_input
          css:
            $label:
              --span: 2
          visible:
            _mql_test:
              select_value_type: String
          properties:
            title: value
            size: small
            $label:
              extra: Display text value.
        - id: block.properties.decimalSeparator
          type: text_input
          defaultValue: "."
          css:
            $label:
              --span: 3
          properties:
            title: decimalSeparator
            size: small
            $label:
              extra: Decimal separator.
        - id: block.properties.formatter.type
          type: select_input
          defaultValue: default
          css:
            $label:
              --span: 3
          properties:
            title: formatter.type
            size: small
            $label:
              extra: Type of formatter to apply to value.
            options:
              - default
              - date
              - humanizeDuration
        - id: block.properties.formatter.properties.format
          type: text_input
          css:
            $label:
              --span: 3
          visible:
            _mql_test:
              block.properties.formatter.type: date
          properties:
            title: formatter.properties.format
            size: small
            $label:
              extra: Moment.js date format
            options:
              - default
              - date
              - humanizeDuration
        - id: block.properties.groupSeparator
          type: text_input
          defaultValue: ","
          css:
            $label:
              --span: 3
          properties:
            title: groupSeparator
            size: small
            $label:
              extra: Group separator.
        - id: block.properties.precision
          type: number_input
          defaultValue: 2
          css:
            $label:
              --span: 2
          properties:
            title: precision
            size: small
            $label:
              extra: Number of decimals to display.
        - id: block.properties.prefix
          type: text_input
          css:
            $label:
              --span: 2
          properties:
            title: prefix
            size: small
            $label:
              extra: Prefix text, priority over $prefix_icon.
        - _ref:
            path: blocks/icon_template.yaml
            vars:
              icon_id: block.properties.$prefix_icon
              icon_field_name: $prefix_icon
              icon_description: Icon to prefix statistic.

        - id: block.properties.suffix
          type: text_input
          css:
            $label:
              --span: 2
          properties:
            title: suffix
            size: small
            $label:
              extra: Suffix text, priority over $suffix_icon.
        - _ref:
            path: blocks/icon_template.yaml
            vars:
              icon_id: block.properties.$suffix_icon
              icon_field_name: $suffix_icon
              icon_description: Icon to suffix statistic.

      available_actions_description: |
        ###### No available actions.

      examples:
        - id: example_1_card
          type: card
          blocks:
            - id: example_1
              type: statistic
              css:
                --span: 6
              properties:
                title: Statistic
                value: 1000
            - id: example_1_code
              type: markdown
              css:
                --span: 6
              properties:
                content: |
                  ```json
                  {
                    "id": "example_1",
                    "type": "statistic",
                    "properties": {
                      "title": "Statistic"
                      "value": 1000
                    }
                  }
                  ```
        - id: example_2_card
          type: card
          blocks:
            - id: example_2
              type: statistic
              css:
                --span: 6
              properties:
                title: Decimal, group separators and precision
                value: 1000.9999
                decimalSeparator: ","
                groupSeparator: " "
                precision: 2
            - id: example_2_code
              type: markdown
              css:
                --span: 6
              properties:
                content: |
                  ```json
                  {
                    "id": "example_2",
                    "type": "statistic",
                    "properties":{
                      "title": "Statistic",
                      "value": 1000.9999,
                      "decimalSeparator": ",",
                      "groupSeparator": " ",
                      "precision": 2
                    }
                  }
                  ```
        - id: example_3_card
          type: card
          blocks:
            - id: example_3
              type: statistic
              css:
                --span: 6
              properties:
                title: Prefix and suffix
                value: 1000
                prefix: $
                $suffix_icon: ShoppingCartOutlined
            - id: example_3_code
              type: markdown
              css:
                --span: 6
              properties:
                content: |
                  ```json
                  {
                    "id": "example_3",
                    "type": "statistic",
                    "properties":{
                      "title": "Prefix and suffix",
                      "value": 1000,
                      "prefix": "$",
                      "$suffix_icon": "ShoppingCartOutlined"
                    }
                  }
                  ```
        - id: example_4_card
          type: card
          blocks:
            - id: example_4
              type: statistic
              css:
                --span: 6
              properties:
                title: Date formatter
                value: 1999-12-31
                formatter:
                  type: date
                  properties:
                    format: D MMMM YYYY

            - id: example_4_code
              type: markdown
              css:
                --span: 6
              properties:
                content: |
                  ```json
                  {
                    "id": "example_4",
                    "type": "statistic",
                    "properties":{
                      "title": "Date formatter",
                      "value": "1999-12-31",
                      "formatter":{
                        "type": "date",
                        "properties":{
                          "format": "D MMMM YYYY"
                        }
                      }
                    }
                  }
                  ```
        - id: example_5_card
          type: card
          blocks:
            - id: example_5
              type: statistic
              css:
                --span: 6
              properties:
                title: Duration formatter
                value: 1000000000
                formatter:
                  type: humanizeDuration

            - id: example_5_code
              type: markdown
              css:
                --span: 6
              properties:
                content: |
                  ```json
                  {
                    "id": "example_5",
                    "type": "statistic",
                    "properties":{
                      "title": "Duration formatter",
                      "value": 1000000000, // value should be milliseconds
                      "formatter":{
                        "type": "humanizeDuration"
                      }
                    }
                  }
                  ```
        - id: example_6_card
          type: card
          blocks:
            - id: example_6
              type: statistic
              css:
                --span: 6
                color: green
                fontWeight: bold
                fontSize: 40
              properties:
                title: Value style
                value: 1000
                $prefix_icon: RiseOutlined
                suffix: "%"

            - id: example_6_code
              type: markdown
              css:
                block:
                  --span: 6
              properties:
                content: |
                  ```json
                  {
                    "id": "example_6",
                    "type": "statistic",
                    "css": {
                      "color": "green",
                      "fontWeight": "bold",
                      "fontSize": 40
                    }
                    "properties":{
                      "title": "Value style",
                      "value": 1000,
                      "$prefix_icon": "RiseOutlined",
                      "suffix": "%"
                    }
                  }
                  ```
