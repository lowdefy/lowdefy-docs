- id: card_display
  type: card
  blocks:
    - id: title
      type: markdown
      properties:
        content:
          _nunjucks:
            template: "### {{ title }}"
            on:
              title:
                _var: block_name

    - id: description
      type: markdown
      properties:
        content:
          _var: description_content
    - id: c1
      type: column
      box:
        span: 10
      blocks:
        - id: block_card
          type: card
          properties:
            title: Block
            size: small
          blocks:
            - id: s2
              type: column
              box:
                span: 2
            - id: block_wrap2
              type: column
              box:
                span: 20
              blocks:
                - id: block_name
                  type:
                    _var: block_type
                  visible:
                    _state: block.visible
                  properties:
                    _state: block.label
                    _if:
                      test:
                        _eq:
                          - _state: select_options_type
                          - Primitive
                      then:
                        _get:
                          key: "0"
                          on:
                            _mql_aggregate:
                              pipeline:
                                - $addFields:
                                    options: $options.primitive
                              on:
                                - _state: block.properties
                      else:
                        _state: block.properties

        - id: state_card
          type: card
          properties:
            title: State
            size: small
          blocks:
            - id: state_markdown
              type: markdown
              properties:
                content:
                  _nunjucks:
                    template: |
                      ```json
                      {
                        "block_name": {{ value | safe }}
                      }
                      ```
                    on:
                      value:
                        _stringify:
                          _state: block_name
    - id: settings_card
      type: card
      box:
        span: 14
        height: 500
      properties:
        title: Settings
        size: small
      blocks:
        - id: visible_description
          type: markdown
          properties:
            content: "#### visible:"
        - id: block.visible
          type: switch_input
          defaultValue: true
          properties:
            size: small
            label:
              extra: Toggle if block is visible and has a value in state.
              span: 4
        - id: label_description
          type: markdown
          visible:
            _var: label
          properties:
            content: "#### label:"
        - id: label_form
          type: column
          visible:
            _var: label
          blocks:
            _var: label_form
        - id: properties_description
          type: markdown
          properties:
            content: "#### properties:"
        - id: properties_form
          type: column
          blocks:
            _var: properties_form
        - id: actions_description
          type: markdown
          properties:
            content: "#### actions:"
        - id: available_actions_description
          type: markdown
          properties:
            content:
              _var: available_actions_description
    - id: examples_card
      type: card
      properties:
        title: Examples
        size: small
      blocks:
        _var: examples
