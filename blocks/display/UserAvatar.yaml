id: UserAvatar
type: PageSiderMenu
public: true
properties:
  title: UserAvatar
blocks:
  _ref:
    path: blocks/template.yaml
    vars:
      block_name: UserAvatar
      description_content: |
        A block to show the user and avatar when logged in, or a login button if not authenticated.
      block_type: UserAvatar
      label: false
      category: display
      style_transform:
        _get:
          key: "0"
          from:
            _mql_aggregate:
              pipeline:
                - $addFields:
                    avatar:
                      _parse:
                        _state: style_avatar_input
                    loginButton:
                      _parse:
                        _state: style_button_input
            on:
              _parse:
                _state: style_block_input
      style_form:
        - id: style_block_input
          type: TextArea
          layout:
            _global: settings_input_layout
          defaultValue: "{}"
          properties:
            title: block
            rows: 3
            size: small
            label:
              span: 8
              extra: CSS Object style properties. Should be in JSON format.
        - id: style_avatar_input
          type: TextArea
          layout:
            _global: settings_input_layout
          defaultValue: "{}"
          properties:
            title: Avatar
            rows: 3
            size: small
            label:
              span: 8
              extra: CSS Object style properties. Should be in JSON format.
        - id: style_button_input
          type: TextArea
          layout:
            _global: settings_input_layout
          defaultValue: "{}"
          properties:
            title: loginButton
            rows: 3
            size: small
            label:
              span: 8
              extra: CSS Object style properties. Should be in JSON format.
      properties_transform:
        _state: block.properties
      properties_form:
        - id: block.properties.disable
          type: Switch
          defaultValue: false
          layout:
            _global: settings_input_layout
          properties:
            title: disable
            size: small
            label:
              span: 8
              extra: Do not render the user menu.
        - id: block.properties.showName
          type: ButtonSelector
          defaultValue: left
          layout:
            _global: settings_input_layout
          properties:
            title: showName
            size: small
            options:
              - left
              - right
              - none
            label:
              span: 8
              extra: Where to position the user name.
        - id: block.properties.name
          type: TextInput
          defaultValue: false
          layout:
            _global: settings_input_layout
          properties:
            title: name
            size: small
            label:
              span: 8
              extra: Replace user name text.
        - id: block.properties.theme
          type: ButtonSelector
          defaultValue: light
          layout:
            _global: settings_input_layout
          properties:
            title: theme
            size: small
            options:
              - light
              - dark
            label:
              span: 8
              extra: Color theme, white or dark name text.
        - id: block.properties.loggedIn
          type: Switch
          defaultValue: true
          layout:
            _global: settings_input_layout
          properties:
            title: loggedIn
            size: small
            label:
              span: 8
              extra: Toggle render as logged in or not.
        - id: block.properties.avatar.shape
          type: ButtonSelector
          defaultValue: circle
          layout:
            _global: settings_input_layout
          properties:
            title: avatar.shape
            size: small
            label:
              span: 8
              extra: Shape of the avatar.
            options:
              - circle
              - square
        - id: block.properties.avatar.link
          type: Anchor
          properties:
            title: See all fields for properties.avatar
            icon: LinkOutlined
          actions:
            onClick: 
              - id: link_Avatar
                type: link()
                params:
                  pageId: Avatar
        - id: block.properties.loginButton.title
          type: TextInput
          defaultValue: Login
          layout:
            _global: settings_input_layout
          properties:
            title: loginButton.title
            size: small
            label:
              span: 8
              extra: Edit login button title.
        - id: block.properties.loginButton.link
          type: Anchor
          properties:
            title: See all fields for properties.loginButton
            Icon: LinkOutlined
          actions:
            onClick: 
              - id: link_loginButton
                type: link()
                params:
                  pageId: Button

      available_actions_description: |
        ###### onClick when clicking on avatar, onLogin when clicking login button

